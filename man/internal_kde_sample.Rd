% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kde_sampling.R
\name{internal_kde_sample}
\alias{internal_kde_sample}
\title{Internal KDE Sampling Function}
\usage{
internal_kde_sample(newX2, S, grid, kde_d2, kde_d3)
}
\arguments{
\item{newX2}{A numeric vector or 1-row matrix with 4 elements. The first three elements are used for
conditional slicing of the KDE, and the fourth determines which KDE object to use.}

\item{S}{The iterations of MCMC sampling.}

\item{grid}{The number of grid points to extract from the KDE in the first dimension.}

\item{kde_d2}{KDE object used when \code{newX2[4] == 2}.}

\item{kde_d3}{KDE object used when \code{newX2[4] == 3}.}
}
\value{
A \code{data.frame} with two columns:
\describe{
\item{RX1i}{A numeric vector of sampled values (length S).}
\item{P}{Predicted density values from the fitted B-spline model.}
}
}
\description{
This function performs posterior sampling of a latent variable based on conditional KDE slices.
It uses B-spline regression to approximate the conditional density and employs Metropolis-Hastings
sampling to draw samples from the approximated posterior.
}
